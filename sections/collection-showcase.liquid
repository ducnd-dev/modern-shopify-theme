{{ 'section-collection-showcase.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}

<section class="collection-showcase bg-white dark:bg-neutral-900 section-{{ section.id }}-padding">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center mb-12">
      {%- if section.settings.badge_text != blank -%}
        <span class="inline-block px-4 py-2 bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 text-sm font-medium rounded-full mb-4">
          {{ section.settings.badge_text }}
        </span>
      {%- endif -%}
      
      {%- if section.settings.heading != blank -%}
        <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-neutral-900 dark:text-neutral-100 mb-4 font-display">
          {{ section.settings.heading }}
        </h2>
      {%- endif -%}
      
      {%- if section.settings.description != blank -%}
        <p class="text-lg text-neutral-600 dark:text-neutral-400 max-w-3xl mx-auto">
          {{ section.settings.description }}
        </p>
      {%- endif -%}
    </div>

    <!-- Collections Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
      {%- for block in section.blocks -%}
        {%- assign collection = collections[block.settings.collection] -%}
        
        <div class="collection-card group relative overflow-hidden rounded-2xl {{ block.settings.card_height }} cursor-pointer" {{ block.shopify_attributes }}>
          <a href="{{ collection.url | default: '#' }}" class="block w-full h-full">
            <!-- Background Image -->
            <div class="absolute inset-0 bg-gradient-to-br from-neutral-100 to-neutral-200 dark:from-neutral-800 dark:to-neutral-700">
              {%- if block.settings.image != blank -%}
                <img 
                  src="{{ block.settings.image | image_url: width: 600 }}"
                  srcset="{{ block.settings.image | image_url: width: 300 }} 300w,
                          {{ block.settings.image | image_url: width: 600 }} 600w,
                          {{ block.settings.image | image_url: width: 900 }} 900w"
                  sizes="(min-width: 1024px) 400px, (min-width: 768px) 350px, 100vw"
                  alt="{{ block.settings.image.alt | escape }}"
                  class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                >
              {%- elsif collection.featured_image -%}
                <img 
                  src="{{ collection.featured_image | image_url: width: 600 }}"
                  srcset="{{ collection.featured_image | image_url: width: 300 }} 300w,
                          {{ collection.featured_image | image_url: width: 600 }} 600w,
                          {{ collection.featured_image | image_url: width: 900 }} 900w"
                  sizes="(min-width: 1024px) 400px, (min-width: 768px) 350px, 100vw"
                  alt="{{ collection.featured_image.alt | escape }}"
                  class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                >
              {%- endif -%}
            </div>

            <!-- Overlay -->
            <div class="absolute inset-0 bg-black/30 group-hover:bg-black/40 transition-all duration-300"></div>

            <!-- Content -->
            <div class="absolute inset-0 flex flex-col justify-end p-6 lg:p-8">
              {%- if block.settings.badge_text != blank -%}
                <span class="inline-block self-start px-3 py-1 bg-white/20 backdrop-blur-sm text-white text-sm font-medium rounded-full mb-4 border border-white/30">
                  {{ block.settings.badge_text }}
                </span>
              {%- endif -%}

              <div class="transform translate-y-2 group-hover:translate-y-0 transition-transform duration-300">
                <h3 class="text-2xl lg:text-3xl font-bold text-white mb-2 font-display">
                  {{ block.settings.title | default: collection.title }}
                </h3>
                
                {%- if block.settings.description != blank -%}
                  <p class="text-white/90 mb-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-100">
                    {{ block.settings.description }}
                  </p>
                {%- elsif collection.description != blank -%}
                  <p class="text-white/90 mb-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-100">
                    {{ collection.description | truncate: 120 }}
                  </p>
                {%- endif -%}

                <div class="flex items-center justify-between">
                  <div class="flex items-center text-white/80 text-sm">
                    {%- if collection.products_count > 0 -%}
                      <span>{{ collection.products_count }} {{ collection.products_count | pluralize: 'product', 'products' }}</span>
                    {%- else -%}
                      <span>{{ block.settings.product_count | default: 'Coming Soon' }}</span>
                    {%- endif -%}
                  </div>

                  <div class="flex items-center text-white transition-transform duration-300 group-hover:translate-x-1">
                    <span class="text-sm font-medium mr-2">{{ block.settings.button_text | default: 'Shop Now' }}</span>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                    </svg>
                  </div>
                </div>
              </div>
            </div>

            <!-- Hover Border Effect -->
            <div class="absolute inset-0 border-2 border-transparent group-hover:border-white/30 rounded-2xl transition-all duration-300 pointer-events-none"></div>
          </a>
        </div>
      {%- endfor -%}
    </div>

    <!-- View All Collections Button -->
    {%- if section.settings.button_label != blank -%}
      <div class="text-center mt-12">
        <a 
          href="{{ section.settings.button_link | default: routes.collections_url }}" 
          class="inline-flex items-center px-8 py-4 bg-primary-600 hover:bg-primary-700 text-white font-semibold rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-primary-500/50"
        >
          {{ section.settings.button_label }}
          <svg class="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      </div>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "Collection Showcase",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "badge_text",
      "label": "Badge text"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Shop by Category"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Discover our carefully curated collections designed for every style and occasion."
    },
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "header",
      "content": "Section padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Custom Image",
          "info": "Will override collection featured image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Custom Title",
          "info": "Will override collection title"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Custom Description",
          "info": "Will override collection description"
        },
        {
          "type": "text",
          "id": "badge_text",
          "label": "Badge text"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button text",
          "default": "Shop Now"
        },
        {
          "type": "text",
          "id": "product_count",
          "label": "Product count text",
          "info": "Only shown if collection has no products"
        },
        {
          "type": "select",
          "id": "card_height",
          "label": "Card height",
          "options": [
            {
              "value": "h-64",
              "label": "Small"
            },
            {
              "value": "h-80",
              "label": "Medium"
            },
            {
              "value": "h-96",
              "label": "Large"
            },
            {
              "value": "h-[28rem]",
              "label": "Extra Large"
            }
          ],
          "default": "h-80"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection Showcase",
      "blocks": [
        {
          "type": "collection",
          "settings": {
            "title": "Women's Fashion",
            "description": "Elegant and contemporary designs for the modern woman",
            "badge_text": "Trending",
            "card_height": "h-96"
          }
        },
        {
          "type": "collection",
          "settings": {
            "title": "Men's Collection",
            "description": "Sophisticated styles for every occasion",
            "card_height": "h-80"
          }
        },
        {
          "type": "collection",
          "settings": {
            "title": "Accessories",
            "description": "Perfect finishing touches for any outfit",
            "badge_text": "New",
            "card_height": "h-80"
          }
        }
      ]
    }
  ]
}
{% endschema %}