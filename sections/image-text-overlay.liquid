{% comment %}
  Image with Text Overlay Section
  Advanced image section with text overlay, parallax effects, and call-to-action
{% endcomment %}

<div class="image-text-overlay-section relative overflow-hidden">
  {% if section.settings.image %}
    <div class="relative {% if section.settings.section_height == 'full' %}h-screen{% elsif section.settings.section_height == 'large' %}h-96 md:h-[32rem]{% else %}h-64 md:h-80{% endif %}">
      
      <!-- Background Image -->
      <div class="absolute inset-0 {% if section.settings.enable_parallax %}parallax-bg{% endif %}">
        <img 
          src="{{ section.settings.image | image_url: width: 1920 }}" 
          alt="{{ section.settings.image.alt | default: section.settings.heading }}"
          class="w-full h-full object-cover {% if section.settings.image_position == 'top' %}object-top{% elsif section.settings.image_position == 'bottom' %}object-bottom{% else %}object-center{% endif %}"
          loading="{% if section.settings.lazy_load %}lazy{% else %}eager{% endif %}"
        >
      </div>

      <!-- Overlay -->
      <div class="absolute inset-0 bg-black bg-opacity-{{ section.settings.overlay_opacity }}"></div>

      <!-- Gradient Overlay (optional) -->
      {% if section.settings.gradient_overlay %}
        <div class="absolute inset-0 bg-gradient-to-{{ section.settings.gradient_direction }} from-black/{{ section.settings.gradient_start_opacity }} to-transparent"></div>
      {% endif %}

      <!-- Content Container -->
      <div class="relative h-full flex items-center justify-center">
        <div class="container mx-auto px-4">
          <div class="max-w-4xl mx-auto text-center text-white">
            
            <!-- Pre-heading -->
            {% if section.settings.preheading != blank %}
              <div class="mb-4 animate-fade-in-up" style="animation-delay: 0.2s;">
                <span class="inline-block text-sm md:text-base font-medium text-{{ section.settings.preheading_color }} bg-{{ section.settings.preheading_bg }} px-4 py-2 rounded-full">
                  {{ section.settings.preheading }}
                </span>
              </div>
            {% endif %}

            <!-- Main Heading -->
            {% if section.settings.heading != blank %}
              <h1 class="text-4xl md:text-6xl lg:text-7xl font-bold mb-6 leading-tight animate-fade-in-up" style="animation-delay: 0.4s;">
                {% assign heading_parts = section.settings.heading | split: section.settings.highlight_word %}
                {% if section.settings.highlight_word != blank and heading_parts.size > 1 %}
                  {{ heading_parts[0] }}<span class="text-{{ section.settings.highlight_color }}">{{ section.settings.highlight_word }}</span>{{ heading_parts[1] }}
                {% else %}
                  {{ section.settings.heading }}
                {% endif %}
              </h1>
            {% endif %}

            <!-- Subheading -->
            {% if section.settings.subheading != blank %}
              <p class="text-lg md:text-xl lg:text-2xl mb-8 text-neutral-200 leading-relaxed max-w-3xl mx-auto animate-fade-in-up" style="animation-delay: 0.6s;">
                {{ section.settings.subheading }}
              </p>
            {% endif %}

            <!-- Call-to-Action Buttons -->
            {% if section.settings.button_text != blank or section.settings.secondary_button_text != blank %}
              <div class="flex flex-col sm:flex-row gap-4 justify-center items-center animate-fade-in-up" style="animation-delay: 0.8s;">
                
                {% if section.settings.button_text != blank %}
                  <a 
                    href="{{ section.settings.button_url | default: '#' }}"
                    class="inline-flex items-center gap-2 bg-{{ section.settings.button_style }} text-{{ section.settings.button_text_color }} px-8 py-4 rounded-full font-semibold text-lg hover:bg-{{ section.settings.button_hover_style }} transition-all duration-300 transform hover:scale-105 shadow-lg"
                    {% if section.settings.button_url == blank %}onclick="event.preventDefault();"{% endif %}
                  >
                    {{ section.settings.button_text }}
                    {% if section.settings.button_icon %}
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        {% case section.settings.button_icon %}
                          {% when 'arrow-right' %}
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                          {% when 'shopping-cart' %}
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m4.5-5a2 2 0 11-4 0 2 2 0 014 0zm6 0a2 2 0 11-4 0 2 2 0 014 0z"></path>
                          {% when 'play' %}
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h1.586a1 1 0 01.707.293l2.414 2.414a1 1 0 00.707.293H15M9 10v4a6 6 0 006 6v-1a5 5 0 00-5-5H9z"></path>
                          {% when 'download' %}
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        {% endcase %}
                      </svg>
                    {% endif %}
                  </a>
                {% endif %}

                {% if section.settings.secondary_button_text != blank %}
                  <a 
                    href="{{ section.settings.secondary_button_url | default: '#' }}"
                    class="inline-flex items-center gap-2 border-2 border-white text-white px-8 py-4 rounded-full font-semibold text-lg hover:bg-white hover:text-neutral-900 transition-all duration-300"
                    {% if section.settings.secondary_button_url == blank %}onclick="event.preventDefault();"{% endif %}
                  >
                    {{ section.settings.secondary_button_text }}
                    {% if section.settings.secondary_button_icon %}
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        {% case section.settings.secondary_button_icon %}
                          {% when 'external-link' %}
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                          {% when 'phone' %}
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                          {% when 'mail' %}
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 7.89a2 2 0 002.83 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                        {% endcase %}
                      </svg>
                    {% endif %}
                  </a>
                {% endif %}
              </div>
            {% endif %}

            <!-- Additional Info/Stats -->
            {% if section.settings.show_stats %}
              <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mt-12 animate-fade-in-up" style="animation-delay: 1s;">
                {% for i in (1..4) %}
                  {% assign stat_number = 'stat_' | append: i | append: '_number' %}
                  {% assign stat_label = 'stat_' | append: i | append: '_label' %}
                  {% if section.settings[stat_number] != blank and section.settings[stat_label] != blank %}
                    <div class="text-center">
                      <div class="text-3xl md:text-4xl font-bold text-white mb-2">
                        {{ section.settings[stat_number] }}
                      </div>
                      <div class="text-sm md:text-base text-neutral-300">
                        {{ section.settings[stat_label] }}
                      </div>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Scroll Indicator -->
      {% if section.settings.show_scroll_indicator %}
        <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
          <div class="w-6 h-10 border-2 border-white rounded-full flex justify-center">
            <div class="w-1 h-3 bg-white rounded-full mt-2 animate-pulse"></div>
          </div>
        </div>
      {% endif %}
    </div>

  {% else %}
    <!-- Fallback when no image is selected -->
    <div class="bg-gradient-to-br from-primary-600 to-primary-800 py-32">
      <div class="container mx-auto px-4 text-center text-white">
        <h2 class="text-4xl md:text-6xl font-bold mb-6">
          {{ section.settings.heading | default: 'Add Your Image' }}
        </h2>
        <p class="text-xl mb-8 text-primary-100">
          {{ section.settings.subheading | default: 'Select an image in the section settings to get started.' }}
        </p>
      </div>
    </div>
  {% endif %}
</div>

<style>
  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in-up {
    animation: fade-in-up 0.8s ease-out forwards;
    opacity: 0;
  }

  .parallax-bg {
    will-change: transform;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Parallax Effect
    const parallaxElements = document.querySelectorAll('.parallax-bg');
    
    if (parallaxElements.length > 0 && window.innerWidth > 768) {
      function updateParallax() {
        parallaxElements.forEach(element => {
          const rect = element.getBoundingClientRect();
          const speed = 0.5;
          const yPos = -(rect.top * speed);
          element.style.transform = `translateY(${yPos}px)`;
        });
      }

      window.addEventListener('scroll', updateParallax);
      updateParallax(); // Initial call
    }

    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "Image with Text Overlay",
  "tag": "section",
  "class": "section-image-text-overlay",
  "settings": [
    {
      "type": "header",
      "content": "Image Settings"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Background Image"
    },
    {
      "type": "select",
      "id": "section_height",
      "label": "Section Height",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "large", 
          "label": "Large"
        },
        {
          "value": "full",
          "label": "Full Screen"
        }
      ],
      "default": "large"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "Image Position",
      "options": [
        {
          "value": "top",
          "label": "Top"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "bottom",
          "label": "Bottom"
        }
      ],
      "default": "center"
    },
    {
      "type": "checkbox",
      "id": "enable_parallax",
      "label": "Enable Parallax Effect",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "lazy_load",
      "label": "Lazy Load Image",
      "default": true
    },
    {
      "type": "header",
      "content": "Overlay Settings"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Overlay Opacity",
      "min": 0,
      "max": 80,
      "step": 10,
      "unit": "%",
      "default": 40
    },
    {
      "type": "checkbox",
      "id": "gradient_overlay",
      "label": "Add Gradient Overlay",
      "default": false
    },
    {
      "type": "select",
      "id": "gradient_direction",
      "label": "Gradient Direction",
      "options": [
        {
          "value": "t",
          "label": "Top to Bottom"
        },
        {
          "value": "b",
          "label": "Bottom to Top"
        },
        {
          "value": "l",
          "label": "Left to Right"
        },
        {
          "value": "r",
          "label": "Right to Left"
        }
      ],
      "default": "b"
    },
    {
      "type": "range",
      "id": "gradient_start_opacity",
      "label": "Gradient Start Opacity",
      "min": 0,
      "max": 100,
      "step": 10,
      "default": 60
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "preheading",
      "label": "Pre-heading"
    },
    {
      "type": "select",
      "id": "preheading_color",
      "label": "Pre-heading Text Color",
      "options": [
        {
          "value": "white",
          "label": "White"
        },
        {
          "value": "primary-600",
          "label": "Primary"
        },
        {
          "value": "neutral-900",
          "label": "Dark"
        }
      ],
      "default": "primary-600"
    },
    {
      "type": "select",
      "id": "preheading_bg",
      "label": "Pre-heading Background",
      "options": [
        {
          "value": "white/20",
          "label": "White Semi-transparent"
        },
        {
          "value": "black/20",
          "label": "Black Semi-transparent"
        },
        {
          "value": "primary-600/20",
          "label": "Primary Semi-transparent"
        }
      ],
      "default": "white/20"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Make an Impact"
    },
    {
      "type": "text",
      "id": "highlight_word",
      "label": "Word to Highlight",
      "info": "This word will be highlighted in a different color"
    },
    {
      "type": "select",
      "id": "highlight_color",
      "label": "Highlight Color",
      "options": [
        {
          "value": "primary-400",
          "label": "Primary"
        },
        {
          "value": "yellow-400",
          "label": "Yellow"
        },
        {
          "value": "green-400",
          "label": "Green"
        },
        {
          "value": "blue-400",
          "label": "Blue"
        },
        {
          "value": "red-400",
          "label": "Red"
        }
      ],
      "default": "primary-400"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "Create something amazing with our powerful tools and expert guidance."
    },
    {
      "type": "header",
      "content": "Primary Button"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Get Started"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button URL"
    },
    {
      "type": "select",
      "id": "button_style",
      "label": "Button Style",
      "options": [
        {
          "value": "primary-600",
          "label": "Primary"
        },
        {
          "value": "white",
          "label": "White"
        },
        {
          "value": "neutral-900",
          "label": "Dark"
        }
      ],
      "default": "primary-600"
    },
    {
      "type": "select",
      "id": "button_text_color",
      "label": "Button Text Color",
      "options": [
        {
          "value": "white",
          "label": "White"
        },
        {
          "value": "neutral-900",
          "label": "Dark"
        },
        {
          "value": "primary-600",
          "label": "Primary"
        }
      ],
      "default": "white"
    },
    {
      "type": "select",
      "id": "button_hover_style",
      "label": "Button Hover Style",
      "options": [
        {
          "value": "primary-700",
          "label": "Primary Dark"
        },
        {
          "value": "neutral-100",
          "label": "Light Gray"
        },
        {
          "value": "neutral-800",
          "label": "Dark Gray"
        }
      ],
      "default": "primary-700"
    },
    {
      "type": "select",
      "id": "button_icon",
      "label": "Button Icon",
      "options": [
        {
          "value": "",
          "label": "None"
        },
        {
          "value": "arrow-right",
          "label": "Arrow Right"
        },
        {
          "value": "shopping-cart",
          "label": "Shopping Cart"
        },
        {
          "value": "play",
          "label": "Play"
        },
        {
          "value": "download",
          "label": "Download"
        }
      ],
      "default": "arrow-right"
    },
    {
      "type": "header",
      "content": "Secondary Button"
    },
    {
      "type": "text",
      "id": "secondary_button_text",
      "label": "Secondary Button Text"
    },
    {
      "type": "url",
      "id": "secondary_button_url",
      "label": "Secondary Button URL"
    },
    {
      "type": "select",
      "id": "secondary_button_icon",
      "label": "Secondary Button Icon",
      "options": [
        {
          "value": "",
          "label": "None"
        },
        {
          "value": "external-link",
          "label": "External Link"
        },
        {
          "value": "phone",
          "label": "Phone"
        },
        {
          "value": "mail",
          "label": "Email"
        }
      ],
      "default": ""
    },
    {
      "type": "header",
      "content": "Statistics"
    },
    {
      "type": "checkbox",
      "id": "show_stats",
      "label": "Show Statistics",
      "default": false
    },
    {
      "type": "text",
      "id": "stat_1_number",
      "label": "Statistic 1 Number"
    },
    {
      "type": "text",
      "id": "stat_1_label",
      "label": "Statistic 1 Label"
    },
    {
      "type": "text",
      "id": "stat_2_number",
      "label": "Statistic 2 Number"
    },
    {
      "type": "text",
      "id": "stat_2_label",
      "label": "Statistic 2 Label"
    },
    {
      "type": "text",
      "id": "stat_3_number",
      "label": "Statistic 3 Number"
    },
    {
      "type": "text",
      "id": "stat_3_label",
      "label": "Statistic 3 Label"
    },
    {
      "type": "text",
      "id": "stat_4_number",
      "label": "Statistic 4 Number"
    },
    {
      "type": "text",
      "id": "stat_4_label",
      "label": "Statistic 4 Label"
    },
    {
      "type": "header",
      "content": "Additional Options"
    },
    {
      "type": "checkbox",
      "id": "show_scroll_indicator",
      "label": "Show Scroll Indicator",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Image with Text Overlay",
      "settings": {
        "heading": "Make an Impact",
        "highlight_word": "Impact",
        "subheading": "Create something amazing with our powerful tools and expert guidance.",
        "button_text": "Get Started",
        "secondary_button_text": "Learn More",
        "section_height": "large",
        "overlay_opacity": 40,
        "enable_parallax": true
      }
    }
  ]
}
{% endschema %}